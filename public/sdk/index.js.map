{"version":3,"sources":["../src/settings.ts","../src/internal/event-emitter.ts","../src/internal/dom.ts","../src/internal/controller-bridge.ts","../src/internal/console.ts","../src/activity.ts","../src/internal/safe-areas.ts","../src/layout.ts","../src/menu.ts","../src/message.ts","../src/variable.ts","../src/input.ts","../src/haptic.ts","../src/internal/request-manager.ts","../src/storage.ts","../src/text-input.ts","../src/air-mouse.ts","../src/air-dpad.ts","../src/motion.ts","../src/audio.ts","../src/telemetry.ts","../src/index.ts"],"sourcesContent":["export const settings = {\n    version: '##VERSION##',\n};\n","// eslint-disable-next-line @typescript-eslint/no-explicit-any\ntype Events = Record<string, any[]>;\ntype UnsubscribeFn = () => void;\n\nexport class EventEmitter<T extends Events = Record<string, unknown[]>> {\n    private readonly eventListeners: {\n        [K in keyof T]?: Set<(...args: T[K]) => void>;\n    } = {};\n\n    get empty(): boolean {\n        return Object.keys(this.eventListeners).length === 0;\n    }\n\n    public on<K extends keyof T>(\n        type: K,\n        listener: (...args: T[K]) => void\n    ): UnsubscribeFn {\n        if (!this.eventListeners[type]) {\n            this.eventListeners[type] = new Set();\n        }\n\n        this.eventListeners[type]?.add(listener);\n\n        return () => {\n            this.off(type, listener);\n        };\n    }\n\n    public off<K extends keyof T>(\n        type: K,\n        listener: (...args: T[K]) => void\n    ): void {\n        this.eventListeners[type]?.delete(listener);\n    }\n\n    public emit<K extends keyof T>(type: K, ...args: T[K]) {\n        this.eventListeners[type]?.forEach((listener) => listener(...args));\n    }\n}\n\n/**\n * A simple event emitter that can be used for a single unnamed event.\n */\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport class SingleEventEmitter<T extends any[] = unknown[]> {\n    private eventEmitter = new EventEmitter<{ event: T }>();\n\n    public on(listener: (...args: T) => void): UnsubscribeFn {\n        return this.eventEmitter.on('event', listener);\n    }\n\n    public off(listener: (...args: T) => void) {\n        this.eventEmitter.off('event', listener);\n    }\n\n    public emit(...args: T) {\n        this.eventEmitter.emit('event', ...args);\n    }\n\n    get empty(): boolean {\n        return this.eventEmitter.empty;\n    }\n}\n","export const hasWindow = typeof window !== 'undefined';\n\nexport function gatherAssetsStatistics() {\n    if (!hasWindow || !performance || !performance.getEntriesByType) {\n        return {\n            transferSizeBytes: 0,\n            encodedBodySizeBytes: 0,\n            decodedBodySizeBytes: 0,\n        };\n    }\n    // Web spec does not define size properties on PerformanceEntryList\n    // but iOS and Android support them.\n    const resources = performance.getEntriesByType('resource') as unknown as {\n        transferSize?: number;\n        encodedBodySize?: number;\n        decodedBodySize?: number;\n    }[];\n    return resources\n        .map((entry) => ({\n            transferSize: entry.transferSize ?? 0,\n            encodedBodySize: entry.encodedBodySize ?? 0,\n            decodedBodySize: entry.decodedBodySize ?? 0,\n        }))\n        .reduce(\n            (acc, curr) => {\n                acc.transferSizeBytes += curr.transferSize;\n                acc.encodedBodySizeBytes += curr.encodedBodySize;\n                acc.decodedBodySizeBytes += curr.decodedBodySize;\n                return acc;\n            },\n            {\n                transferSizeBytes: 0,\n                encodedBodySizeBytes: 0,\n                decodedBodySizeBytes: 0,\n            }\n        );\n}\n\nexport function absoluteUrl(url: string): string {\n    return new URL(url, window.location.href).toString();\n}\n","import { EventEmitter } from './event-emitter.js';\nimport { hasWindow } from './dom.js';\nimport type {\n    IncomingMessage,\n    IncomingMessageData,\n    OutgoingMessage,\n} from './types.js';\n\ntype IncomingMessageEvents = {\n    [K in IncomingMessage['type']]: [event: IncomingMessageData<K>];\n};\n\n/**\n * A fully typed bi-directional bridge to communicate with the controller. It can receive\n * messages which are emitted as events and it can send messages.\n */\nclass ControllerBridge extends EventEmitter<IncomingMessageEvents> {\n    constructor() {\n        super();\n        this.registerMessageEventListener();\n    }\n\n    public send(message: OutgoingMessage, transfer?: Transferable[]) {\n        if (hasWindow) {\n            window.parent.postMessage(message, '*', transfer);\n        }\n    }\n\n    private registerMessageEventListener() {\n        if (hasWindow) {\n            window.addEventListener(\n                'message',\n                ({ data }: MessageEvent<IncomingMessage>) => {\n                    this.emit(\n                        data.type,\n                        'data' in data ? data.data : undefined\n                    );\n                }\n            );\n        }\n    }\n}\n\nexport const controllerBridge = new ControllerBridge();\n","import { hasWindow } from './dom.js';\nimport { controllerBridge } from './controller-bridge.js';\n\nexport function injectConsoleListener() {\n    if (!hasWindow) {\n        return;\n    }\n\n    (['log', 'info', 'debug', 'warn', 'error'] as const).forEach((method) => {\n        const original = window.console[method];\n        window.console[method] = (...args: unknown[]) => {\n            original.apply(window.console, args);\n\n            // 1. Create the error here to capture the stack at this moment.\n            const err = new Error();\n\n            // 2. Pass the stack string to extract the location info.\n            const location = parseStackTrace(err.stack);\n\n            controllerBridge.send({\n                type: 'console',\n                data: {\n                    level: method === 'log' ? 'info' : method,\n                    location,\n                    args: serializeArgs(args),\n                },\n            });\n        };\n    });\n\n    window.addEventListener('error', (event) => {\n        controllerBridge.send({\n            type: 'console',\n            data: {\n                level: 'error',\n                location: {\n                    filename: getDocumentRelativePath(event.filename),\n                    line: event.lineno,\n                    col: event.colno,\n                },\n                args: [event.message],\n            },\n        });\n    });\n}\n\nfunction serializeArgs(args: unknown[]): unknown[] {\n    return args.map((arg) => {\n        try {\n            return structuredClone(arg);\n        } catch {\n            try {\n                return JSON.parse(JSON.stringify(arg));\n            } catch {\n                return String(arg);\n            }\n        }\n    });\n}\n\nfunction getDocumentRelativePath(filename: string): string {\n    if (filename.startsWith(document.location.origin)) {\n        filename = filename.replace(document.location.origin, '');\n        const pathName = document.location.pathname;\n        // Determine base path (directory) of current document\n        const basePath = pathName.endsWith('/')\n            ? pathName\n            : pathName.substring(0, pathName.lastIndexOf('/') + 1);\n        if (filename.startsWith(basePath)) {\n            filename = filename.substring(basePath.length);\n        }\n        if (filename.endsWith(document.location.hash)) {\n            filename = filename.replace(document.location.hash, '');\n        }\n    }\n    return filename;\n}\n\nfunction parseStackTrace(stack: string = ''): {\n    filename: string;\n    line: number;\n    col: number;\n} {\n    const stackLines = stack.split('\\n');\n    let filename = 'unknown';\n    let line = 0;\n    let col = 0;\n\n    // Regex for Chromium (V8) stack traces.\n    // e.g., \"at myFunction (path/to/file.js:10:25)\"\n    const chromiumRegex = /at (?:(.*?) ?\\()?(.+?):(\\d+):(\\d+)\\)?/;\n\n    // Regex for WebKit (Safari) stack traces.\n    // e.g., \"@https://webroot--b2whemaeitmo4ti-1vd367n.r.ssic.dev/index.js\"\n    const webkitRegex = /@(.*?):(\\d+):(\\d+)/;\n\n    const userAgent = navigator.userAgent;\n    const isIOS =\n        /iPad|iPhone|iPod/.test(userAgent) ||\n        (/Macintosh/.test(userAgent) && navigator.maxTouchPoints > 1);\n    const isWKWebView =\n        isIOS &&\n        /AppleWebKit/.test(userAgent) &&\n        //@ts-expect-error - webkit property exist in Safari\n        !!window.webkit?.messageHandlers;\n\n    // Chromium has \"Error \\n\" at index 0 and the wrapper (controller-sdk) at index 1. The filename of the call site at index 2.\n    // WebKit has the wrapper (controller-sdk) at index 0. The filename of the call site at index 1.\n    const callSite = (isWKWebView ? stackLines[1] : stackLines[2]) || ''.trim();\n    const chromiumMatch = callSite.match(chromiumRegex);\n    const webkitMatch = callSite.match(webkitRegex);\n\n    if (chromiumMatch) {\n        filename = chromiumMatch[2];\n        line = parseInt(chromiumMatch[3], 10);\n        col = parseInt(chromiumMatch[4], 10);\n    } else if (webkitMatch) {\n        filename = webkitMatch[1];\n        line = webkitMatch[2] ? parseInt(webkitMatch[2], 10) : 0;\n        // Column info isn't available in this Safari format.\n        col = 0;\n    }\n\n    return {\n        filename: getDocumentRelativePath(filename),\n        line,\n        col,\n    };\n}\n","import { hasWindow, controllerBridge } from './internal/index.js';\n\ntype Activity = {\n    startActivityMonitor(): void;\n    stopActivityMonitor(): void;\n};\n\nconst USER_ACTIVITY_THRESHOLD_MS = 1000;\n\nlet started = false;\nlet lastActivityTime = 0;\nlet waitingToSendActivityMessage = false;\n\n/**\n * This is for calculating CtGl.\n */\nfunction sendTouchEventMessage(timestamp: number) {\n    controllerBridge.send({\n        type: 'touchInput',\n        data: { eventTimestamp: timestamp },\n    });\n}\n\nfunction sendActivityMessage(time = Date.now()) {\n    lastActivityTime = time;\n    waitingToSendActivityMessage = false;\n    controllerBridge.send({ type: 'activityUserActive' });\n}\n\nfunction handlePointerUp(event: PointerEvent) {\n    const currentTime = Date.now();\n    const deltaTime = currentTime - lastActivityTime;\n\n    sendTouchEventMessage(event.timeStamp);\n\n    if (waitingToSendActivityMessage) {\n        return;\n    }\n\n    if (deltaTime >= USER_ACTIVITY_THRESHOLD_MS) {\n        sendActivityMessage(currentTime);\n    } else {\n        waitingToSendActivityMessage = true;\n        setTimeout(sendActivityMessage, USER_ACTIVITY_THRESHOLD_MS - deltaTime);\n    }\n}\n\nexport const activity: Activity = {\n    startActivityMonitor() {\n        if (!hasWindow || started) {\n            return;\n        }\n\n        started = true;\n\n        window.document.addEventListener('pointerup', handlePointerUp, {\n            capture: true,\n            passive: true,\n        });\n    },\n    stopActivityMonitor() {\n        if (!hasWindow || !started) {\n            return;\n        }\n\n        started = false;\n        window.document.removeEventListener('pointerup', handlePointerUp);\n    },\n};\n","export function injectSafeArea({\n    top = 0,\n    right = 0,\n    bottom = 0,\n    left = 0,\n} = {}) {\n    if (typeof window === 'undefined') {\n        return;\n    }\n    const root = document.documentElement;\n    root.style.setProperty('--safe-area-inset-top', `${top}px`);\n    root.style.setProperty('--safe-area-inset-right', `${right}px`);\n    root.style.setProperty('--safe-area-inset-bottom', `${bottom}px`);\n    root.style.setProperty('--safe-area-inset-left', `${left}px`);\n}\n","import {\n    injectConsoleListener,\n    controllerBridge,\n    type IncomingMessageData,\n    SingleEventEmitter,\n    gatherAssetsStatistics,\n} from './internal/index.js';\nimport type { NetflixControllerError } from './types.js';\nimport { activity } from './activity.js';\nimport { settings } from './settings.js';\nimport { injectSafeArea } from './internal/safe-areas.js';\n\nexport type LayoutConfiguration = IncomingMessageData<'init'>;\ntype VisibilityHandler = (isLayoutVisible: boolean) => void;\n\nexport enum ScreenOrientation {\n    PORTRAIT = 'portrait',\n    LANDSCAPE = 'landscape',\n    ANY = 'any',\n}\nexport type OrientationChangeEvent = {\n    orientation: ScreenOrientation;\n    safeAreaInsetTop: number;\n    safeAreaInsetBottom: number;\n    safeAreaInsetLeft: number;\n    safeAreaInsetRight: number;\n};\ntype OrientationChangeHandler = (event: OrientationChangeEvent) => void;\n\nlet initConfiguration: LayoutConfiguration | undefined;\nlet isReady = false;\n\nexport enum ControllerView {\n    PLAYER_SUPPORT = 'PLAYER_SUPPORT',\n}\n\ntype Layout = {\n    /**\n     * This function is called as soon at the custom built layout is\n     * starting to load. The layouts configuration is returned. This\n     * configuration can be used to finalize the initialization of\n     * the page content.\n     */\n    beginInit(\n        callback: (\n            error: NetflixControllerError | undefined,\n            layoutConfig: LayoutConfiguration\n        ) => void\n    ): void;\n    /**\n     * Once the custom built layout page is ready, it should call the\n     * finishInit function to notify the Netflix Controller that it can complete the\n     * init sequence. After this call, the custom built layout page must be ready to\n     * be shown to the user.\n     */\n    finishInit(\n        callback?: (error: NetflixControllerError | undefined) => void\n    ): void;\n    addVisibilityHandler(handler: VisibilityHandler): void;\n    removeVisibilityHandler(handler: VisibilityHandler): void;\n    getVisibility(\n        callback: (\n            error: NetflixControllerError | undefined,\n            isLayoutVisible: boolean\n        ) => void\n    ): void;\n    lockOrientation(orientation: ScreenOrientation): void;\n    addOrientationChangeHandler(handler: OrientationChangeHandler): void;\n    removeOrientationChangeHandler(handler: OrientationChangeHandler): void;\n\n    setDebugContextField: (options: { key: string; value: string }) => void;\n    showView: (options: { view: ControllerView }) => void;\n};\n\nconst visibilityEventEmitter = new SingleEventEmitter<\n    Parameters<VisibilityHandler>\n>();\nlet currentVisibilityState = false;\n\ncontrollerBridge.on('layoutVisible', () => {\n    currentVisibilityState = true;\n    visibilityEventEmitter.emit(currentVisibilityState);\n});\n\ncontrollerBridge.on('layoutHidden', () => {\n    currentVisibilityState = false;\n    visibilityEventEmitter.emit(currentVisibilityState);\n});\n\nconst orientationEventEmitter = new SingleEventEmitter<\n    Parameters<OrientationChangeHandler>\n>();\ncontrollerBridge.on('deviceOrientationChange', (event) => {\n    injectSafeArea({\n        top: event.safeAreaInsetTop,\n        bottom: event.safeAreaInsetBottom,\n        left: event.safeAreaInsetLeft,\n        right: event.safeAreaInsetRight,\n    });\n    orientationEventEmitter.emit(event);\n});\n\nexport const layout: Layout = {\n    beginInit(callback) {\n        // init can only be called once, if called more than once,\n        // it will return the same promise.\n        if (initConfiguration) {\n            callback(undefined, initConfiguration);\n        } else {\n            const unsubscribe = controllerBridge.on('init', (configuration) => {\n                initConfiguration = configuration;\n                injectConsoleListener();\n                injectSafeArea({\n                    top: configuration.safeAreaInsetTop,\n                    bottom: configuration.safeAreaInsetBottom,\n                    left: configuration.safeAreaInsetLeft,\n                    right: configuration.safeAreaInsetRight,\n                });\n                callback(undefined, initConfiguration);\n                unsubscribe();\n            });\n            controllerBridge.send({\n                type: 'loading',\n                data: { sdkVersion: settings.version },\n            });\n        }\n    },\n    finishInit(callback) {\n        if (!isReady) {\n            isReady = true;\n\n            const assetsStatistics = gatherAssetsStatistics();\n            controllerBridge.send({\n                type: 'ready',\n                data: { assetsStatistics },\n            });\n            activity.startActivityMonitor();\n        }\n\n        if (callback) {\n            callback(undefined);\n        }\n    },\n    addVisibilityHandler(handler) {\n        visibilityEventEmitter.on(handler);\n    },\n    removeVisibilityHandler(handler) {\n        visibilityEventEmitter.off(handler);\n    },\n    getVisibility(callback) {\n        callback(undefined, currentVisibilityState);\n    },\n    lockOrientation(orientation: ScreenOrientation) {\n        controllerBridge.send({\n            type: 'lockOrientation',\n            data: { orientation },\n        });\n    },\n    addOrientationChangeHandler(handler) {\n        orientationEventEmitter.on(handler);\n    },\n    removeOrientationChangeHandler(handler) {\n        orientationEventEmitter.off(handler);\n    },\n    setDebugContextField: (options) => {\n        controllerBridge.send({\n            type: 'setDebugContextField',\n            data: options,\n        });\n    },\n    showView: (options) => {\n        controllerBridge.send({\n            type: 'showView',\n            data: options,\n        });\n    },\n};\n","import {\n    controllerBridge,\n    type IncomingMessageHandler,\n    type IncomingMessageData,\n    SingleEventEmitter,\n} from './internal/index.js';\n\nexport type MenuButtonState = IncomingMessageData<'customMenuButton'>;\nexport type MenuMessageHandler = IncomingMessageHandler<'customMenuButton'>;\n\ntype Menu = {\n    addMenuHandler(handler: MenuMessageHandler): void;\n    removeMenuHandler(handler: MenuMessageHandler): void;\n};\n\nconst eventEmitter = new SingleEventEmitter<Parameters<MenuMessageHandler>>();\n\ncontrollerBridge.on('customMenuButton', (buttonState) => {\n    eventEmitter.emit(buttonState);\n});\n\nexport const menu: Menu = {\n    addMenuHandler(handler) {\n        eventEmitter.on(handler);\n    },\n    removeMenuHandler(handler) {\n        eventEmitter.off(handler);\n    },\n};\n","import {\n    controllerBridge,\n    SingleEventEmitter,\n    type IncomingMessageData,\n} from './internal/index.js';\nimport type { NetflixControllerError, SendErrorCode } from './types.js';\n\nconst errorCodeMessages = {\n    NO_ERROR: 'No error',\n    UNKNOWN_CLIENT_ID: 'Unknown client id',\n    NOT_CONNECTED: 'Not connected',\n    SEND_ERROR: 'Send error',\n    TIMEOUT: 'Timeout',\n} as const satisfies Record<SendErrorCode, string>;\n\nexport type ReceiveHandler = (\n    data: IncomingMessageData<'message'>['data']\n) => void;\n\ntype GameMessageCallback = (\n    error: NetflixControllerError<SendErrorCode> | undefined\n) => void;\n\ntype GameMessage = {\n    send(data: string | ArrayBuffer, callback: GameMessageCallback): void;\n    addReceiveHandler(handler: ReceiveHandler): void;\n    removeReceiveHandler(handler: ReceiveHandler): void;\n};\n\nconst eventEmitter = new SingleEventEmitter<Parameters<ReceiveHandler>>();\n\ncontrollerBridge.on('message', (data) => {\n    eventEmitter.emit(data.data);\n});\n\nlet lastMessageId = 0;\nconst messageTimeout = 5000;\nconst pendingMessages: Map<number, GameMessageCallback> = new Map();\n\ncontrollerBridge.on('messageAck', (ack) => {\n    const callback = pendingMessages.get(ack.messageId);\n    if (typeof callback === 'function') {\n        if (!ack.delivered) {\n            const message = errorCodeMessages[ack.errorCode] ?? 'Unknown error';\n            callback({ message, code: ack.errorCode });\n        } else {\n            callback(undefined);\n        }\n    }\n});\n\nexport const gameMessage: GameMessage = {\n    send(data, callback) {\n        const messageId = lastMessageId++;\n\n        const timeout = setTimeout(() => {\n            pendingMessages.delete(messageId);\n            callback({ message: 'Send timeout', code: 'TIMEOUT' });\n        }, messageTimeout);\n\n        pendingMessages.set(messageId, (error) => {\n            clearTimeout(timeout);\n            pendingMessages.delete(messageId);\n            callback(error);\n        });\n\n        // If the data is an ArrayBuffer, we need to send it as a transferable\n        // to avoid serialization.\n        const transfer = data instanceof ArrayBuffer ? [data] : undefined;\n        controllerBridge.send(\n            { type: 'message', data: { messageId, data } },\n            transfer\n        );\n    },\n    addReceiveHandler(handler) {\n        eventEmitter.on(handler);\n    },\n    removeReceiveHandler(handler) {\n        eventEmitter.off(handler);\n    },\n};\n","import { SingleEventEmitter, controllerBridge } from './internal/index.js';\nimport type { NetflixControllerError } from './types.js';\n\ntype GameVariableChangeHandler = (name: string, value: string) => void;\n\ntype GameVariable = {\n    addChangeHandler(handler: GameVariableChangeHandler): void;\n    removeChangeHandler(handler: GameVariableChangeHandler): void;\n    get(\n        name: string,\n        callback: (\n            error: NetflixControllerError | undefined,\n            value: string | undefined\n        ) => void\n    ): void;\n};\n\nconst eventEmitter = new SingleEventEmitter<\n    Parameters<GameVariableChangeHandler>\n>();\nconst variables: Record<string, string> = {};\n\ncontrollerBridge.on('variable', (data) => {\n    variables[data.name] = data.value;\n    eventEmitter.emit(data.name, data.value);\n});\n\nexport const gameVariable: GameVariable = {\n    addChangeHandler(handler) {\n        eventEmitter.on(handler);\n    },\n    removeChangeHandler(handler) {\n        eventEmitter.off(handler);\n    },\n    get(name, callback) {\n        return callback(undefined, variables[name]);\n    },\n};\n","import { controllerBridge } from './internal/index.js';\n\nexport const enum GamepadButton {\n    BTN_A = 'BTN_A',\n    BTN_B = 'BTN_B',\n    BTN_X = 'BTN_X',\n    BTN_Y = 'BTN_Y',\n    BTN_Z = 'BTN_Z',\n    BTN_TL = 'BTN_TL',\n    BTN_TR = 'BTN_TR',\n    BTN_TL2 = 'BTN_TL2',\n    BTN_TR2 = 'BTN_TR2',\n    BTN_SELECT = 'BTN_SELECT',\n    BTN_START = 'BTN_START',\n    BTN_MODE = 'BTN_MODE',\n    BTN_THUMBL = 'BTN_THUMBL',\n    BTN_THUMBR = 'BTN_THUMBR',\n    BTN_DPAD_LEFT = 'BTN_DPAD_LEFT',\n    BTN_DPAD_RIGHT = 'BTN_DPAD_RIGHT',\n    BTN_DPAD_UP = 'BTN_DPAD_UP',\n    BTN_DPAD_DOWN = 'BTN_DPAD_DOWN',\n}\n\nexport const enum MouseButton {\n    BTN_LEFT = 'BTN_LEFT',\n    BTN_RIGHT = 'BTN_RIGHT',\n}\n\nexport const enum GamepadAxis {\n    X = 'ABS_X',\n    Y = 'ABS_Y',\n    RIGHT_X = 'ABS_RX',\n    RIGHT_Y = 'ABS_RY',\n}\n\nexport type MousePosition = {\n    x: number;\n    y: number;\n};\n\nexport type MouseMovement = {\n    deltaX: number;\n    deltaY: number;\n};\n\ntype Input = {\n    setGamepadButton(button: GamepadButton, state: boolean): void;\n    setGamepadAxis(axis: GamepadAxis, value: number): void;\n    setMouseButton(button: MouseButton, state: boolean): void;\n    setMousePosition(position: MousePosition): void;\n    setMouseMovement(movement: MouseMovement): void;\n    setMousePositionAndMovement(\n        position: MousePosition,\n        movement: MouseMovement\n    ): void;\n};\n\nconst buttonStates = new Map<GamepadButton, boolean>();\nconst axisStates = new Map<GamepadAxis, number>();\nconst mouseButtonStates = new Map<MouseButton, boolean>();\n\nexport const input: Input = {\n    setGamepadButton(button, state) {\n        if (buttonStates.get(button) !== state) {\n            buttonStates.set(button, state);\n            controllerBridge.send({\n                type: 'input',\n                data: [{ code: button, value: state }],\n            });\n        }\n    },\n    setGamepadAxis(axis, value) {\n        if (axisStates.get(axis) !== value) {\n            axisStates.set(axis, value);\n            controllerBridge.send({\n                type: 'input',\n                data: [{ code: axis, value }],\n            });\n        }\n    },\n    setMouseButton(button: MouseButton, state: boolean): void {\n        if (mouseButtonStates.get(button) !== state) {\n            mouseButtonStates.set(button, state);\n            controllerBridge.send({\n                type: 'mouse',\n                data: [{ code: button, value: state }],\n            });\n        }\n    },\n    setMousePosition(position: MousePosition): void {\n        controllerBridge.send({\n            type: 'mouse',\n            data: [\n                { code: 'ABS_X', value: position.x, isRawValue: true },\n                { code: 'ABS_Y', value: position.y, isRawValue: true },\n            ],\n        });\n    },\n    setMouseMovement(movement: MouseMovement): void {\n        controllerBridge.send({\n            type: 'mouse',\n            data: [\n                { code: 'REL_X', value: movement.deltaX },\n                { code: 'REL_Y', value: movement.deltaY },\n            ],\n        });\n    },\n    setMousePositionAndMovement(\n        position: MousePosition,\n        movement: MouseMovement\n    ): void {\n        controllerBridge.send({\n            type: 'mouse',\n            data: [\n                { code: 'ABS_X', value: position.x, isRawValue: true },\n                { code: 'ABS_Y', value: position.y, isRawValue: true },\n                { code: 'REL_X', value: movement.deltaX },\n                { code: 'REL_Y', value: movement.deltaY },\n            ],\n        });\n    },\n};\n","import { absoluteUrl, controllerBridge } from './internal/index.js';\n\nexport enum HapticPreset {\n    TAP = 'TAP',\n    HOVER = 'HOVER',\n    TICK = 'TICK',\n    SUCCESS = 'SUCCESS',\n    ERROR = 'ERROR',\n    LIGHT = 'LIGHT',\n    MEDIUM = 'MEDIUM',\n    HEAVY = 'HEAVY',\n    SHARP = 'SHARP',\n    SOFT = 'SOFT',\n    DOUBLE_TAP_SHARP = 'DOUBLE_TAP_SHARP',\n    DOUBLE_TAP_SOFT = 'DOUBLE_TAP_SOFT',\n    TRIPLE_TAP_SHARP = 'TRIPLE_TAP_SHARP',\n    TRIPLE_TAP_SOFT = 'TRIPLE_TAP_SOFT',\n    BUZZ = 'BUZZ',\n    SHORT_BUZZ = 'SHORT_BUZZ',\n}\n\ntype CreateHapticOptions = {\n    id: string;\n    presetId: HapticPreset;\n    audioUrl?: string;\n};\n\ntype PlayHapticOptions = {\n    id: string;\n};\n\ntype Haptics = {\n    create(options: CreateHapticOptions): void;\n    play(options: PlayHapticOptions): void;\n    stop(): void;\n};\n\nexport const haptics: Haptics = {\n    create(options) {\n        controllerBridge.send({\n            type: 'haptics',\n            data: {\n                action: 'create',\n                id: options.id,\n                presetId: options.presetId,\n                audioUrl: options.audioUrl\n                    ? absoluteUrl(options.audioUrl)\n                    : undefined,\n            },\n        });\n    },\n    play(options) {\n        controllerBridge.send({\n            type: 'haptics',\n            data: { action: 'play', id: options.id },\n        });\n    },\n    stop() {\n        controllerBridge.send({\n            type: 'haptics',\n            data: { action: 'stop' },\n        });\n    },\n};\n","import type { NetflixControllerError } from '../types.js';\nimport type { IncomingMessage, IncomingMessageData } from './types.js';\nimport { controllerBridge } from './controller-bridge.js';\n\ntype IncomingResponseMessage = {\n    [K in IncomingMessage['type']]: IncomingMessageData<K> extends {\n        requestId: number;\n        error?: NetflixControllerError;\n    }\n        ? K\n        : never;\n}[IncomingMessage['type']];\n\ntype IncomingResponseMessageEvents = {\n    [K in IncomingResponseMessage]: IncomingMessageData<K>;\n};\n\nexport class RequestManager<T extends keyof IncomingResponseMessageEvents> {\n    private currentRequestId = 0;\n    private requestMap = new Map();\n\n    constructor(responseEventType: T) {\n        controllerBridge.on(responseEventType, (response) => {\n            const { requestId, error, data } =\n                response as IncomingResponseMessageEvents[T] extends {\n                    requestId: number;\n                    error?: NetflixControllerError;\n                    data?: unknown;\n                }\n                    ? IncomingResponseMessageEvents[T]\n                    : never;\n\n            const callback = this.requestMap.get(requestId);\n            if (!callback || typeof callback !== 'function') {\n                console.warn(\n                    `RequestManager: Callback not found or callback is not a function for request id ${requestId}`\n                );\n                return;\n            }\n\n            callback(error, data);\n            this.requestMap.delete(requestId);\n        });\n    }\n\n    private getNextRequestId() {\n        return ++this.currentRequestId;\n    }\n\n    // Registers the callback with a unique request id and return the id to be\n    // included in the request.\n    registerCallback(\n        callback: (\n            error: IncomingResponseMessageEvents[T] extends { error: infer D }\n                ? D\n                : never,\n            data: IncomingResponseMessageEvents[T] extends { data: infer D }\n                ? D\n                : never\n        ) => void\n    ) {\n        const requestId = this.getNextRequestId();\n        // this really should not happen, but just in case, we log a warning\n        // here but don't throw error\n        if (this.requestMap.has(requestId)) {\n            console.warn(\n                `RequestManager: Request id ${requestId} already exists`\n            );\n        }\n\n        this.requestMap.set(requestId, callback);\n        return requestId;\n    }\n}\n","import { controllerBridge } from './internal/index.js';\nimport { RequestManager } from './internal/request-manager.js';\nimport type { NetflixControllerError } from './types.js';\n\ntype StorageCallback = (error: NetflixControllerError | undefined) => void;\n\ntype StorageGetCallback = (\n    error: NetflixControllerError | undefined,\n    data?: unknown\n) => void;\n\nconst requestManager = new RequestManager('storageResponse');\n\ntype Storage = {\n    set: (\n        options: { key: string; value: string },\n        callback: StorageCallback\n    ) => void;\n    get: (options: { key: string }, callback: StorageGetCallback) => void;\n    getAll: (callback: StorageGetCallback) => void;\n    remove: (options: { key: string }, callback: StorageCallback) => void;\n    clear: (callback: StorageCallback) => void;\n};\n\nexport const storage: Storage = {\n    set: (options, callback) => {\n        const { key, value } = options;\n\n        const requestId = requestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'storage',\n            action: 'set',\n            data: { requestId, key, value },\n        });\n    },\n    get: (options, callback) => {\n        const { key } = options;\n\n        const requestId = requestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'storage',\n            action: 'get',\n            data: { requestId, key },\n        });\n    },\n    getAll: (callback) => {\n        const requestId = requestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'storage',\n            action: 'getAll',\n            data: { requestId },\n        });\n    },\n    remove: (options, callback) => {\n        const { key } = options;\n\n        const requestId = requestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'storage',\n            action: 'remove',\n            data: { requestId, key },\n        });\n    },\n    clear: (callback) => {\n        const requestId = requestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'storage',\n            action: 'clear',\n            data: { requestId },\n        });\n    },\n};\n","import {\n    controllerBridge,\n    type IncomingMessageData,\n    type OutgoingMessageData,\n    type IncomingMessageHandler,\n    SingleEventEmitter,\n} from './internal/index.js';\nimport type { NetflixControllerError } from './types.js';\n\nexport type OpenTextInputOptions = OutgoingMessageData<'openTextInput'>;\nexport type TextInputEvent = IncomingMessageData<'textInputEvent'>;\ntype TextInputChangeHandler = IncomingMessageHandler<'textInputEvent'>;\n\ntype TextInput = {\n    /**\n     * Opens the text input UI. On each user action, a TextInputEvent\n     * will be sent to the app. You can use closeTextInput to close it.\n     */\n    open(\n        options: OpenTextInputOptions,\n        callback: (error: NetflixControllerError | undefined) => void\n    ): void;\n    /**\n     * closeTextInput is used to close the text input UI opened with\n     * openTextInput. It is usually called as a result of a TextInputEvent\n     * with type 'submit' or 'cancel'. The text input UI won't close by\n     * itself. It is the responsibility of the app to close it using this\n     * function.\n     */\n    close(callback: (error: NetflixControllerError | undefined) => void): void;\n    addChangeHandler(handler: TextInputChangeHandler): void;\n    removeChangeHandler(handler: TextInputChangeHandler): void;\n};\n\nconst eventEmitter = new SingleEventEmitter<\n    Parameters<TextInputChangeHandler>\n>();\n\ncontrollerBridge.on('textInputEvent', (event) => {\n    eventEmitter.emit(event);\n});\n\ncontrollerBridge.on('motionEventsChannel', (event) => {\n    const port = event.port;\n    if (port) {\n        port.onmessage = (event) => {\n            eventEmitter.emit(event.data);\n        };\n    }\n});\n\nexport const textInput: TextInput = {\n    open(options, callback) {\n        controllerBridge.send({ type: 'openTextInput', data: options });\n        callback(undefined);\n    },\n    close(callback) {\n        controllerBridge.send({ type: 'closeTextInput' });\n        callback(undefined);\n    },\n    addChangeHandler(handler) {\n        eventEmitter.on(handler);\n    },\n    removeChangeHandler(handler) {\n        eventEmitter.off(handler);\n    },\n};\n","import { controllerBridge } from './internal/index.js';\nimport type { NetflixControllerError } from './types.js';\n\ntype AirMouseCallback = (error: NetflixControllerError | undefined) => void;\n\nexport const enum AirMouseButton {\n    BTN_LEFT = 'BTN_LEFT',\n    BTN_RIGHT = 'BTN_RIGHT',\n}\n\nexport const enum AirMouseFilter {\n    NONE = 'NONE',\n    PRECISE = 'PRECISE',\n}\n\ntype AirMouse = {\n    start(\n        options: {\n            userEducation: boolean;\n            filter?: AirMouseFilter;\n        },\n        callback: AirMouseCallback\n    ): void;\n    stop(callback: AirMouseCallback): void;\n    setButton(\n        code: AirMouseButton,\n        pressed: boolean,\n        eventTimestamp: number,\n        callback: AirMouseCallback\n    ): void;\n};\n\nexport const airMouse: AirMouse = {\n    start(options, callback) {\n        controllerBridge.send({ type: 'airMouse.start', data: options });\n        callback(undefined);\n    },\n    stop(callback) {\n        controllerBridge.send({ type: 'airMouse.stop' });\n        callback(undefined);\n    },\n    setButton(code, pressed, eventTimestamp, callback) {\n        controllerBridge.send({\n            type: 'airMouse.setMouseButton',\n            data: { code, pressed, eventTimestamp },\n        });\n        callback(undefined);\n    },\n};\n","import { controllerBridge } from './internal/index.js';\nimport type { NetflixControllerError } from './types.js';\n\ntype AirDpadCallback = (error: NetflixControllerError | undefined) => void;\n\nexport type AirDpadOptions = {\n    constraint?: 'horizontal' | 'vertical';\n    deltaAngleDeg?: number;\n};\n\ntype AirDpad = {\n    start(options: AirDpadOptions, callback: AirDpadCallback): void;\n    stop(callback: AirDpadCallback): void;\n};\n\nexport const airDpad: AirDpad = {\n    start(options, callback) {\n        controllerBridge.send({ type: 'startAirDpad', data: options });\n        callback(undefined);\n    },\n    stop(callback) {\n        controllerBridge.send({ type: 'stopAirDpad' });\n        callback(undefined);\n    },\n};\n","import { controllerBridge } from './internal/controller-bridge.js';\nimport { SingleEventEmitter } from './internal/event-emitter.js';\n\nexport type Vector3 = {\n    x: number;\n    y: number;\n    z: number;\n};\n\nexport type Quaternion = {\n    x: number;\n    y: number;\n    z: number;\n    w: number;\n};\n\nexport type MotionEvent = {\n    // The time at which the event occurred, in seconds to microseconds\n    // granularity.\n    timestamp: number;\n\n    // Returns the attitude (ie, orientation in space) of the device.\n    attitude: Quaternion;\n\n    // Returns the gravity acceleration vector expressed in the device's reference frame.\n    gravity: Vector3;\n\n    // Returns rotation rate as measured by the device's gyroscope.\n    //\n    // The rotation rate is given as a Vector3 representing the speed of\n    // rotation around each of the three axes in radians per second. This is the\n    // value as it is reported by the gyroscope hardware - a more accurate\n    // measurement that has been processed to remove \"bias\" can be obtained with\n    // the rotationRateUnbiased property.\n    rotationRate: Vector3;\n\n    // Returns unbiased rotation rate as measured by the device's gyroscope.\n    //\n    // The rotation rate is given as a Vector3 representing the speed of\n    // rotation around each of the three axes in radians per second. This value\n    // has been processed to remove \"bias\" and give a more accurate measurement.\n    // The raw value reported by the gyroscope hardware can be obtained with the\n    // rotationRate property.\n    rotationRateUnbiased: Vector3;\n\n    // Returns the acceleration that the user is giving to the device.\n    //\n    // The significance of this value is that the effect of gravity (which is\n    // also detected by the accelerometer) has been removed to leave just the\n    // acceleration from the user's movements.\n    userAcceleration: Vector3;\n};\n\nconst eventEmitter = new SingleEventEmitter<[MotionEvent]>();\n\ncontrollerBridge.on('motionEventsChannel', (event) => {\n    const port = event.port;\n    if (port) {\n        port.onmessage = (event) => {\n            const motionEvent: MotionEvent = event.data;\n            eventEmitter.emit(motionEvent);\n        };\n    }\n});\n\nexport const motion = {\n    addHandler: (handler: (event: MotionEvent) => void) => {\n        if (eventEmitter.empty) {\n            controllerBridge.send({ type: 'startMotionEvents' });\n        }\n        eventEmitter.on(handler);\n    },\n\n    removeHandler: (handler: (event: MotionEvent) => void) => {\n        eventEmitter.off(handler);\n        if (eventEmitter.empty) {\n            controllerBridge.send({ type: 'stopMotionEvents' });\n        }\n    },\n};\n","import { controllerBridge } from './internal/controller-bridge.js';\nimport { absoluteUrl } from './internal/dom.js';\nimport { RequestManager } from './internal/request-manager.js';\nimport type { NetflixControllerError } from './types.js';\n\nexport type CreateMemoryAudioSourceOptions = {\n    url: string;\n    loop?: boolean;\n};\n\nexport type CreateStreamingAudioSourceOptions = {\n    url: string;\n    prepared?: boolean;\n};\n\nexport type SourceUpdateHandlerHandler = (event: {\n    source: AudioSource;\n}) => void;\n\nexport type UpdateAudioSourceOptions = {\n    sourceId: string;\n    currentTime?: number;\n    playing?: boolean;\n    muted?: boolean;\n    volume?: number;\n};\n\nexport type CloseAudioSourceOptions = {\n    sourceId: string;\n};\n\nexport enum AudioSourcePlaybackState {\n    PAUSED = 'paused',\n    BUFFERING = 'buffering',\n    PLAYING = 'playing',\n    ENDED = 'ended',\n    ERROR = 'error',\n}\n\nexport type AudioSourceState = {\n    state: AudioSourcePlaybackState;\n    currentTime: number;\n    bufferProgress: number;\n    duration?: number;\n    isMuted: boolean;\n    volume: number;\n    error?: string;\n};\n\nexport type AudioSourceUpdateEvent = AudioSourceState & {\n    sourceId: string;\n};\n\nexport type AudioSettings = {\n    // This is true when the user disables controller audio in the\n    // Netflix Controller settings. This is different from the device's\n    // mute switch. When this setting is set, all audio sources will\n    // be force-muted. If the game depends on audio, you may nudge them\n    // to toggle this setting.\n    isDisabled: boolean;\n\n    // This is true when the device's volume is below a threshold that\n    // may make your audio inaudible. If you game depends on audio\n    // being audible, you may instruct the user to turn up the volume\n    // of their device.\n    isDeviceVolumeLow: boolean;\n};\n\nexport type AudioSettingsUpdateHandler = (event: AudioSettings) => void;\n\nconst createSourceRequestManager = new RequestManager('audio.sourceCreated');\nconst updateSourceRequestManager = new RequestManager('audio.sourceUpdated');\nconst closeSourceRequestManager = new RequestManager('audio.sourceClosed');\n\nconst updateHandlers = new Map<string, SourceUpdateHandlerHandler[]>();\nconst audioSourceInstances = new Map<string, AudioSource>();\nconst sourceState = new Map<string, AudioSourceState>();\n\ncontrollerBridge.on('audio.sourceUpdate', (event) => {\n    const { sourceId, ...state } = event;\n    sourceState.set(event.sourceId, state);\n    const source = audioSourceInstances.get(sourceId);\n    if (source) {\n        const event = { source };\n        updateHandlers.get(sourceId)?.forEach((handler) => handler(event));\n    }\n});\n\nlet audioSettings = {\n    isDisabled: false,\n    isDeviceVolumeLow: false,\n};\nconst audioSettingsChangeHandlers: AudioSettingsUpdateHandler[] = [];\n\ncontrollerBridge.on('audio.settingsChange', (settings) => {\n    audioSettings = settings;\n    audioSettingsChangeHandlers.forEach((handler) => handler(settings));\n});\n\ntype Audio = {\n    createMemorySource(\n        options: CreateMemoryAudioSourceOptions,\n        callback: (\n            error: NetflixControllerError | undefined,\n            data: { source?: AudioSource }\n        ) => void\n    ): void;\n    createStreamingSource(\n        options: CreateStreamingAudioSourceOptions,\n        callback: (\n            error: NetflixControllerError | undefined,\n            data: { source?: AudioSource }\n        ) => void\n    ): void;\n    getSettings(\n        callback: (\n            error: NetflixControllerError | undefined,\n            settings: AudioSettings\n        ) => void\n    ): void;\n    addSettingsChangeHandler(handler: AudioSettingsUpdateHandler): void;\n    removeSettingsChangeHandler(handler: AudioSettingsUpdateHandler): void;\n};\n\nfunction createAudioSourceCallbackAdaptor(\n    audioSourceType: 'memory' | 'streaming',\n    callback: (\n        error: NetflixControllerError | undefined,\n        data: { source?: AudioSource }\n    ) => void\n): (\n    error: NetflixControllerError | undefined,\n    data: { sourceId?: string }\n) => void {\n    return (\n        error: NetflixControllerError | undefined,\n        data: { sourceId?: string }\n    ) => {\n        if (!data?.sourceId) {\n            return callback(error, { source: undefined });\n        }\n        const source = new AudioSourceInternal(data.sourceId);\n        audioSourceInstances.set(data.sourceId, source);\n        // Initialize the source state with default values\n        sourceState.set(data.sourceId, {\n            state: AudioSourcePlaybackState.PAUSED,\n            currentTime: 0,\n            bufferProgress: audioSourceType === 'memory' ? 1 : 0,\n            isMuted: false,\n            volume: 1,\n        });\n        callback(error, { source });\n    };\n}\n\nexport const audio: Audio = {\n    createMemorySource(options, callback) {\n        const internalCallback = createAudioSourceCallbackAdaptor(\n            'memory',\n            callback\n        );\n        const requestId =\n            createSourceRequestManager.registerCallback(internalCallback);\n        controllerBridge.send({\n            type: 'audio.createMemorySource',\n            data: {\n                requestId,\n                ...options,\n                url: absoluteUrl(options.url),\n            },\n        });\n    },\n    createStreamingSource(options, callback) {\n        const internalCallback = createAudioSourceCallbackAdaptor(\n            'streaming',\n            callback\n        );\n        const requestId =\n            createSourceRequestManager.registerCallback(internalCallback);\n        controllerBridge.send({\n            type: 'audio.createStreamingSource',\n            data: {\n                requestId,\n                ...options,\n                url: absoluteUrl(options.url),\n            },\n        });\n    },\n    getSettings(callback) {\n        callback(undefined, audioSettings);\n    },\n    addSettingsChangeHandler(handler) {\n        audioSettingsChangeHandlers.push(handler);\n    },\n    removeSettingsChangeHandler(handler) {\n        const index = audioSettingsChangeHandlers.indexOf(handler);\n        if (index !== -1) {\n            audioSettingsChangeHandlers.splice(index, 1);\n        }\n    },\n};\n\nexport type AudioSource = InstanceType<typeof AudioSourceInternal>;\n\n// Do not export the implementation so it cannot be instantiated directly.\nclass AudioSourceInternal {\n    constructor(readonly id: string) {}\n\n    toJSON() {\n        return { ...sourceState.get(this.id), id: this.id };\n    }\n\n    addUpdateHandler(handler: SourceUpdateHandlerHandler): void {\n        const handlers = updateHandlers.get(this.id) ?? [];\n        handlers.push(handler);\n        updateHandlers.set(this.id, handlers);\n    }\n\n    removeUpdateHandler(handler: SourceUpdateHandlerHandler): void {\n        const handlers = updateHandlers.get(this.id);\n        if (handlers) {\n            const index = handlers.indexOf(handler);\n            if (index !== -1) {\n                handlers.splice(index, 1);\n                updateHandlers.set(this.id, handlers);\n            }\n        }\n    }\n\n    get bufferProgress() {\n        const state = sourceState.get(this.id);\n        return state?.bufferProgress ?? -1;\n    }\n\n    play(callback: (error: NetflixControllerError | undefined) => void): void;\n    play(\n        options: { from: number },\n        callback: (error: NetflixControllerError | undefined) => void\n    ): void;\n    play(\n        optionsOrCallback:\n            | { from: number }\n            | ((error: NetflixControllerError | undefined) => void),\n        maybeCallback?: (error: NetflixControllerError | undefined) => void\n    ): void {\n        const hasOptions = typeof optionsOrCallback === 'object';\n        const options = hasOptions\n            ? (optionsOrCallback as { from: number })\n            : undefined;\n        const callback = hasOptions\n            ? maybeCallback!\n            : (optionsOrCallback as (\n                  error: NetflixControllerError | undefined\n              ) => void);\n\n        const requestId = updateSourceRequestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'audio.updateSource',\n            data: {\n                requestId,\n                sourceId: this.id,\n                playing: true,\n                ...(options?.from !== undefined\n                    ? { currentTime: options.from }\n                    : {}),\n            },\n        });\n    }\n\n    pause(callback: (error: NetflixControllerError | undefined) => void) {\n        const requestId = updateSourceRequestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'audio.updateSource',\n            data: { requestId, sourceId: this.id, playing: false },\n        });\n    }\n\n    get state() {\n        const state = sourceState.get(this.id);\n        return state?.state ?? 'error';\n    }\n\n    seek(\n        currentTime: number,\n        callback: (error: NetflixControllerError | undefined) => void\n    ) {\n        const requestId = updateSourceRequestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'audio.updateSource',\n            data: { requestId, sourceId: this.id, currentTime },\n        });\n    }\n\n    get currentTime() {\n        const state = sourceState.get(this.id);\n        return state?.currentTime ?? -1;\n    }\n\n    get duration() {\n        const state = sourceState.get(this.id);\n        return state?.duration ?? -1;\n    }\n\n    mute(\n        muted: boolean,\n        callback: (error: NetflixControllerError | undefined) => void\n    ) {\n        const requestId = updateSourceRequestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'audio.updateSource',\n            data: { requestId, sourceId: this.id, muted },\n        });\n    }\n\n    get isMuted() {\n        const state = sourceState.get(this.id);\n        return state?.isMuted ?? false;\n    }\n\n    setVolume(\n        volume: number,\n        callback: (error: NetflixControllerError | undefined) => void\n    ) {\n        const requestId = updateSourceRequestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'audio.updateSource',\n            data: { requestId, sourceId: this.id, volume },\n        });\n    }\n\n    get volume() {\n        const state = sourceState.get(this.id);\n        return state?.volume ?? -1;\n    }\n\n    get error() {\n        const state = sourceState.get(this.id);\n        return state?.error;\n    }\n\n    close(callback: (error: NetflixControllerError | undefined) => void) {\n        const requestId = closeSourceRequestManager.registerCallback(callback);\n        controllerBridge.send({\n            type: 'audio.closeSource',\n            data: { requestId, sourceId: this.id },\n        });\n        updateHandlers.delete(this.id);\n        sourceState.delete(this.id);\n        audioSourceInstances.delete(this.id);\n    }\n}\n","import { controllerBridge } from './internal/controller-bridge.js';\n\nexport type TelemetryEvent = {\n    eventName: string;\n    eventData: Record<string, unknown>;\n    version: number;\n    environment: string;\n};\n\ntype Telemetry = {\n    logEvent(event: TelemetryEvent): void;\n};\n\nexport const telemetry: Telemetry = {\n    logEvent(event: TelemetryEvent) {\n        controllerBridge.send({\n            type: 'telemetry',\n            action: 'logEvent',\n            data: {\n                event,\n            },\n        });\n    },\n};\n","import { settings } from './settings.js';\n\nexport const VERSION = settings.version;\n\nexport * from './layout.js';\nexport * from './menu.js';\nexport * from './message.js';\nexport * from './types.js';\nexport * from './variable.js';\nexport * from './input.js';\nexport * from './haptic.js';\nexport * from './storage.js';\nexport * from './text-input.js';\nexport * from './air-mouse.js';\nexport * from './air-dpad.js';\nexport * from './motion.js';\nexport * from './audio.js';\nexport * from './telemetry.js';\nexport type { IncomingMessage, OutgoingMessage } from './internal/index.js';\n"],"mappings":"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","names":["e","ScreenOrientation","ControllerView","eventEmitter","eventEmitter","GamepadButton","MouseButton","GamepadAxis","HapticPreset","eventEmitter","event","AirMouseButton","AirMouseFilter","eventEmitter","event","AudioSourcePlaybackState","event","settings"]}